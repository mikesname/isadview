@(result: solr.models.Description, maybeUser: Option[models.sql.User], savedItems: List[Long])


<div class="search-result@if(result.publication_status == 0) { draft }" data-slug="@result.slug">
    @maybeUser.map { user =>
        @user.profile.map { profile =>
        <div class="bookmark-controls" data-item="@result.id">
            <a class="show-save-item-list" href="#">
            @if(savedItems.contains(result.id.toLong)) {
                <i class="icon-star"></i>
            } else {
                <i class="icon-bookmark"></i>
            }
            </a>

            <div class="save-item-list">
                <h4>Save item</h4>
                <p>
                <ul>
                    @profile.virtualCollections.map { vc =>
                    <li>
                        <a class="save-item" href="@routes.VirtualCollections.saveItem(result.id.toLong, vc.id)">@vc.name</a>
                    </li>
                    }   
                </ul>
                </p>
                <form class="stash-new-collection-form form-horizontal" action="@routes.VirtualCollections.saveItemToNew(result.id.toLong)" method="POST">
                    <div class="input-append">
                        <input placeholder="@Messages("Save to new collection...")" class="span8" name="name" type="text" />
                        <input type="submit" class="btn btn-small" value="@Messages("Save")" />
                    </div>
                </form>
            </div>
        </div>
        }
    }

    <div class="search-result-content">
    @if(result.django_ct == "portal.repository") {
        <h4><a href="@routes.Repositories.detail(slug=result.slug)">@result.name</a></h4>
    } else {
        @if(result.django_ct == "portal.collection") {
        <h4>
            <a href="@routes.Collections.detail(slug=result.slug)">@result.name</a>
            <span class="collection-repo">
                <a href="@routes.Repositories.detail(slug=result.repository_slug)">@result.repository</a>
            </span>
        </h4>
        } else {
        <h4><a href="@routes.Authorities.detail(slug=result.slug)">@result.name</a></h4>
        }
    }
    @if(result.other_names.nonEmpty) {
        <h5 class="alternate-names">@result.other_names.mkString(", ")</h5>
    }
    <p>
        @if(result.publication_status == 0) {
            <span class="label">@Messages("Draft")</span>
        }
        @{result.django_ct match {
        case "portal.repository" =>
            result.asInstanceOf[solr.models.Repository].description.slice(0, 200)
        case "portal.authority" =>
            result.asInstanceOf[solr.models.Authority].history.slice(0, 200)
        case "portal.collection" =>
            result.asInstanceOf[solr.models.Collection].description.slice(0, 200)
        }}
    </p>
    </div>
</div>

